!function(e){var t={};function i(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(s,o,function(t){return e[t]}.bind(null,o));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=6)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,o=i(2);!function(e){e[e.empty=0]="empty",e[e.pawn=1]="pawn",e[e.rook=2]="rook",e[e.knight=3]="knight",e[e.bishop=4]="bishop",e[e.queen=5]="queen",e[e.king=6]="king"}(t.PIECETYPE||(t.PIECETYPE={})),function(e){e[e.black=0]="black",e[e.white=1]="white"}(t.SIDE||(t.SIDE={})),function(e){e[e.a=0]="a",e[e.b=1]="b",e[e.c=2]="c",e[e.d=3]="d",e[e.e=4]="e",e[e.f=5]="f",e[e.g=6]="g",e[e.h=7]="h"}(s=t.FILE||(t.FILE={})),t.LIGHTSQCOLOR=o.colorSqLight,t.DARKSQCOLOR=o.colorSqDark,t.POSSIBLESQCOLOR=o.colorSqPossible,t.CASTLEABLESQCOLOR=o.colorSqCastleable,t.NUMRANKS=8,t.NUMFILES=Object.keys(s).length/2,t.CELLWIDTH=o.cellWidth,t.PIECESPRITEWIDTH=o.spriteWidth,t.CANVASMARGIN=o.canvasMargin,t.UIFONTLARGE=o.uiFontLarge,t.UIFONTSMALL=o.uiFontSmall,t.UIFONTBTN=o.uiFontBtn,t.CAPITALIZE=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.GETENUMKEY=function(e,t){var i,s=Object.keys(e);return s.forEach((function(o,r){var n=e[o];parseInt(n,10)>=0&&r-s.length/2==t&&(i=e[n])})),i}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),o=i(4),r=function(){function e(e,t,i){this._coord="",this._forward=1,this.active=!1,this.captured=!1,this.possibleMoves=new Array,this.side=s.SIDE.white,this.type=s.PIECETYPE.pawn,this.value=100,this.side=e,this.type=t,this._forward=this.side==s.SIDE.white?1:-1,this._id=i}return e.prototype._iterateMoves=function(e,t,i,o){for(var r=new Array;e.cellInBounds(t);){var n=s.FILE[t[0]]+i,c=parseInt(t[1])+o;if(t!=this.getCoord()){var a=e.getCellByCoord(t);if(a.isOccupied()){a.piece.side!=this.side&&(r.push(t),a.possibleMove=!0);break}r.push(t),a.possibleMove=!0}t=""+s.FILE[n]+c}return r},e.prototype.canMove=function(e){return console.error("Piece.canMove: canMove has not been implemented!"),[]},e.prototype.draw=function(e,t,i,o,r){var n=e.naturalWidth-this.type*s.PIECESPRITEWIDTH,c=this.side==s.SIDE.white?0:s.PIECESPRITEWIDTH,a=s.PIECESPRITEWIDTH,h=s.PIECESPRITEWIDTH;t.drawImage(e,n,c,a,h,i,o,r,r)},e.prototype.getCoord=function(){return this._coord},e.prototype.getDiagMoves=function(e,t,i){var s=this.getCoord(),o=i?1:-1,r=(t?1:-1)*this._forward;return this._iterateMoves(e,s,o,r)},e.prototype.getId=function(){return this._id},e.prototype.getPerpMoves=function(e,t,i){var s=this.getCoord(),o=t?0:i?1:-1,r=t?(i?1:-1)*this._forward:0;return this._iterateMoves(e,s,o,r)},e.prototype.getPieceType=function(){return s.CAPITALIZE(s.GETENUMKEY(s.PIECETYPE,this.type))},e.prototype.getSide=function(){return s.CAPITALIZE(s.GETENUMKEY(s.SIDE,this.side))},e.prototype.overrideCoord=function(e){this._coord=e},e.prototype.move=function(e){return!!(e instanceof o.Cell&&this.possibleMoves.includes(e.getCoord()))&&(this._coord=e.getCoord(),e.piece=this,this.possibleMoves=[],!0)},e}();t.Piece=r},function(e){e.exports=JSON.parse('{"canvasId":"chess_board","piecesImgId":"pieces_img","canvasMargin":20,"cellWidth":80,"spriteWidth":100,"colorSqLight":"#919191","colorSqDark":"#333","colorSqPossible":"#40ff00","colorSqCastleable":"#5900b3","uiFontLarge":"bold 20px Raleway","uiFontSmall":"16px Raleway","uiFontBtn":"bold 15px Raleway"}')},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),o=i(4),r=function(){function e(e,t){this._canvas_offset_x=0,this._canvas_offset_y=0,this.cells=new Array,this.canvas=e,this.pieces_img=t,this.ctx=e.getContext("2d");var i=s.NUMFILES*s.CELLWIDTH;s.NUMRANKS,s.CELLWIDTH;this._canvas_offset_x=(e.width-i)/2,this._canvas_offset_y=s.CANVASMARGIN+150;for(var r=0;r<s.NUMRANKS;r++)for(var n=0;n<s.NUMFILES;n++){var c=!!((r+n)%2);this.cells.push(new o.Cell(n,r+1,c))}}return e.prototype._validateCoord=function(e){if(2!=e.length)return!1;if(isNaN(parseInt(e[0]))&&Object.keys(s.FILE).includes(e[0])){var t=parseInt(e[1]);return!(isNaN(t)||t>s.NUMRANKS||t<1)}return!1},e.prototype.cellInBounds=function(e){return this._validateCoord(e)},e.prototype.clearPossible=function(){this.cells.forEach((function(e){e.possibleMove=!1,e.castleable=!1}))},e.prototype.draw=function(){var e=this,t=s.LIGHTSQCOLOR,i=s.DARKSQCOLOR,o=s.CELLWIDTH;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath(),this.ctx.fillStyle="#121212",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.closePath(),this.cells.forEach((function(r){var n=r.file*o+e._canvas_offset_x,c=s.NUMRANKS*o-o*(r.rank-1)-o+e._canvas_offset_y;if(e.ctx.beginPath(),e.ctx.fillStyle=r.isLight?t:i,r.isOccupied()&&r.piece.active&&(e.ctx.fillStyle=s.POSSIBLESQCOLOR),e.ctx.fillRect(n,c,o,o),e.ctx.closePath(),e.ctx.beginPath(),e.ctx.fillStyle=r.isLight?i:t,e.ctx.font=s.UIFONTBTN,1==r.rank&&e.ctx.fillText(s.FILE[r.file],n+o-10,c+o-5),r.file==s.FILE.a&&e.ctx.fillText(r.rank+"",n+3,c+15),e.ctx.closePath(),r.possibleMove){var a=n+3,h=c+3,u=o-6;e.ctx.beginPath(),e.ctx.lineWidth=6,e.ctx.strokeStyle=s.POSSIBLESQCOLOR,r.castleable&&(e.ctx.strokeStyle=s.CASTLEABLESQCOLOR),e.ctx.rect(a,h,u,u),e.ctx.stroke(),e.ctx.closePath()}r.isOccupied()&&r.piece.draw(e.pieces_img,e.ctx,n,c,o)}))},e.prototype.getCellByCoord=function(e){if(this._validateCoord(e)){var t=e[0],i=parseInt(e[1])*s.NUMFILES-s.NUMRANKS+s.FILE[t];return this.cells[i]}},e.prototype.getCellByPixels=function(e,t){var i=s.FILE[Math.floor((e-this._canvas_offset_x)/s.CELLWIDTH)],o=s.NUMRANKS-Math.floor((t-this._canvas_offset_y)/s.CELLWIDTH);return this.getCellByCoord(""+i+o)},e}();t.Board=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),o=function(){function e(e,t,i){return this.castleable=!1,this.file=0,this.isLight=!1,this.possibleMove=!1,this.piece=null,this.rank=0,t>s.NUMRANKS||t<1?(console.error("Cell.constructor: Invalid rank value."),null):(this.file=e,this.rank=t,this.isLight=!!i,this)}return e.prototype.getFile=function(){return s.GETENUMKEY(s.FILE,this.file)},e.prototype.getCoord=function(){return""+this.getFile()+this.rank},e.prototype.isOccupied=function(){return null!=this.piece},e}();t.Cell=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),o=i(12),r=i(13),n=i(14),c=i(15),a=i(16),h=i(17),u=function(){function e(e){this.captures=new Array,this.pieces=new Array,this.kingInCheck=!1,this.side=e==s.SIDE.white?s.SIDE.white:s.SIDE.black,this.pieces.push(new n.Pawn(this.side,0)),this.pieces.push(new n.Pawn(this.side,1)),this.pieces.push(new n.Pawn(this.side,2)),this.pieces.push(new n.Pawn(this.side,3)),this.pieces.push(new n.Pawn(this.side,4)),this.pieces.push(new n.Pawn(this.side,5)),this.pieces.push(new n.Pawn(this.side,6)),this.pieces.push(new n.Pawn(this.side,7)),this.pieces.push(new h.Rook(this.side,8)),this.pieces.push(new h.Rook(this.side,9)),this.pieces.push(new c.Knight(this.side,10)),this.pieces.push(new c.Knight(this.side,11)),this.pieces.push(new o.Bishop(this.side,12)),this.pieces.push(new o.Bishop(this.side,13)),this.pieces.push(new a.Queen(this.side,14)),this.pieces.push(new r.King(this.side,15))}return e.prototype.clearPossible=function(){this.activePiece=null,this.pieces.forEach((function(e){e.active=!1,e.possibleMoves=[]}))},e.prototype.getPieceById=function(e){if(e>=0&&e<=15)return this.pieces.find((function(t){return t.getId()==e}))},e.prototype.getSide=function(){return s.CAPITALIZE(s.SIDE[this.side])},e.prototype.getScore=function(){for(var e=0,t=0;t<this.captures.length;t++){e+=this.captures[t].value}return e},e}();t.Team=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(7);var s=i(2),o=i(0),r=i(3),n=i(8),c=i(5);window.addEventListener("load",(function(e){var t=document.getElementById(s.canvasId),i=document.getElementById(s.piecesImgId),a=new n.Match(new r.Board(t,i),new c.Team(o.SIDE.white),new c.Team(o.SIDE.black));a.draw(),t.addEventListener("click",(function(e){a.click(e)}))}))},function(e,t,i){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),o=i(3),r=i(9),n=i(10),c=i(5),a=i(18),h=function(){function e(e,t,i){return this.checkmate=!1,this.turns=new Array,t.side!=i.side?(this.board=e,this.team1=t,this.team2=i,this.setupPieces(this.team1),this.setupPieces(this.team2),this.ai=new r.ChessAi(this.board),this.ui=new n.ChessUi,this):(console.error("Match.constructor: teams must be on different sides."),null)}return e.prototype.clearPossible=function(){this.board.clearPossible(),this.team1.clearPossible(),this.team2.clearPossible()},e.prototype.click=function(e){var t=this.board.getCellByPixels(e.offsetX,e.offsetY),i=this.team1.side==this.whosTurn()?this.team1:this.team2;if(this.checkmate)this.ui.clickedResetBtn(e)&&this.reset();else if(t&&t.isOccupied()&&t.piece.side==i.side){var o=t.piece;this.clearPossible(),i.activePiece=o,o.canMove(this.board),this.draw()}else if(null!=i.activePiece&&t.possibleMove){if(this.startTurn(i.activePiece,t),this.board.getCellByCoord(i.activePiece.getCoord()).piece=null,i.activePiece.type==s.PIECETYPE.king){var r=i.activePiece;this.turns[this.turns.length-1].castleRookId=r.castleMove(t,this.board)}else i.activePiece.move(t);this.finishTurn(),this.clearPossible(),this.draw()}else this.ui.clickedUndoBtn(e)?this.undoMove():this.ui.clickedLoadBtn(e)?this.load():this.ui.clickedResetBtn(e)?this.reset():this.ui.clickedSaveBtn(e)?this.save():(this.clearPossible(),this.draw())},e.prototype.draw=function(){this.board.draw(),this.ui.draw(this.board.ctx,this.getWhiteTeam().getScore(),this.getBlackTeam().getScore(),this.turns)},e.prototype.finishTurn=function(){var e=this.team1.side==this.whosTurn()?this.team1:this.team2,t=e.side==this.team1.side?this.team2:this.team1;if(this.isTeamInCheck(t)&&(this.checkmate=this.ai.detectCheckMate(t,e)),this.isTeamInCheck(e)&&!this.checkmate&&(this.checkmate=this.ai.detectCheckMate(e,t)),this.checkmate){var i=e.getPieceById(15);this.updateStatus("CHECKMATE!!! "+t.getSide()+" wins!"),i.captured=!0,t.captures.push(i),this.turns[this.turns.length-1].capture=Object.assign({},i)}else this.updateStatus("It's "+e.getSide()+"'s turn.")},e.prototype.getBlackTeam=function(){return this.team1.side==s.SIDE.black?this.team1:this.team2},e.prototype.getWhiteTeam=function(){return this.team1.side==s.SIDE.white?this.team1:this.team2},e.prototype.isTeamInCheck=function(e){var t=e.pieces[15].getCoord(),i=e.side==s.SIDE.white?this.getBlackTeam():this.getWhiteTeam();return this.ai.detectCheck(t,i)?(this.updateStatus(e.getSide()+"'s king is in check!"),e.kingInCheck=!0,!0):(1==e.kingInCheck&&(this.updateStatus(e.getSide()+"'s king is no longer in check!"),e.kingInCheck=!1),!1)},e.prototype.load=function(){var e=this,t=JSON.parse(window.localStorage.getItem("Typechess_Save")),i=function(t,i,s){var o=s.pieces[i],r=e.board.getCellByCoord(t.getCoord());t.captured=o.captured,r.piece=r.piece==t?null:r.piece,t.captured||(t.possibleMoves=[o._coord],t.move(e.board.getCellByCoord(o._coord)))};t?(this.reset(),this.team1.pieces.forEach((function(e,s){i(e,s,t.team1)})),this.team2.pieces.forEach((function(e,s){i(e,s,t.team2)})),t.team1.captures&&t.team1.captures instanceof Array&&t.team1.captures.forEach((function(t){e.team1.captures.push(t)})),t.team2.captures&&t.team2.captures instanceof Array&&t.team2.captures.forEach((function(t){e.team2.captures.push(t)})),t.turns&&t.turns instanceof Array&&t.turns.forEach((function(t){var i,o=(t.side==s.SIDE.white?e.getWhiteTeam():e.getBlackTeam()).getPieceById(t.movedPiece._id),r=o.getCoord();o.overrideCoord(t.startCoord),i=new a.Turn(o,t.endCoord),o.overrideCoord(r),i.msgs=t.msgs,i.capture=t.capture,i.castleRookId=t.castleRookId,e.turns.push(i)})),this.draw(),alert("Game Loaded!")):alert("No save found!")},e.prototype.reset=function(){this.constructor(new o.Board(this.board.canvas,this.board.pieces_img),new c.Team(s.SIDE.white),new c.Team(s.SIDE.black)),this.draw()},e.prototype.save=function(){new Date;window.localStorage.setItem("Typechess_Save",JSON.stringify({team1:this.team1,team2:this.team2,turns:this.turns})),alert("Game saved!")},e.prototype.setupPieces=function(e){var t=this,i=Object.keys(s.FILE),o=e.side==s.SIDE.white?"2":"7",r=e.side==s.SIDE.white?"1":"8";e.pieces.forEach((function(e,n){var c="";n<i.length&&e.type==s.PIECETYPE.pawn?c=i[n+i.length/2]+o:8==n?c="a"+r:9==n?c="h"+r:10==n?c="b"+r:11==n?c="g"+r:12==n?c="c"+r:13==n?c="f"+r:14==n?c="d"+r:15==n&&(c="e"+r),e.move(t.board.getCellByCoord(c))}))},e.prototype.startTurn=function(e,t){var i=new a.Turn(e,t.getCoord()),s=e.side==this.team1.side?this.team1:this.team2,o=s.getSide()+" moved "+s.activePiece.getPieceType()+"("+s.activePiece.getCoord().toUpperCase()+") to "+t.getCoord().toUpperCase()+".";if(this.turns.push(i),this.updateStatus(o),t.isOccupied()){var r,n=s.side==this.team1.side?this.team2.getSide():this.team1.getSide(),c=s.getSide()+" captured "+n+" "+t.piece.getPieceType()+"("+t.getCoord().toUpperCase()+") +"+t.piece.value+"pts.";t.piece.captured=!0,r=Object.assign({},t.piece),i.capture=r,s.captures.push(r),this.updateStatus(c)}},e.prototype.undoMove=function(){if(0!=this.turns.length){var e=this.turns[this.turns.length-1],t=e.movedPiece,i=e.capture,o=e.side==s.SIDE.white?this.getWhiteTeam():this.getBlackTeam();if(this.board.getCellByCoord(t.getCoord()).piece=null,t.possibleMoves=[e.startCoord],t.move(this.board.getCellByCoord(e.startCoord)),t.type==s.PIECETYPE.rook||t.type==s.PIECETYPE.pawn||t.type==s.PIECETYPE.king){var r=t;null!=r.hasMoved&&null!=r.origCoord&&r.origCoord.includes(e.startCoord)&&(r.hasMoved=!1)}if(null!=i){for(var n=o,c=o.side==s.SIDE.white?this.getBlackTeam():this.getWhiteTeam(),a=0;a<c.pieces.length;a++){var h=c.pieces[a];if(h.captured&&h.getId()==i._id){h.captured=!1,h.possibleMoves=[e.endCoord],h.move(this.board.getCellByCoord(e.endCoord));break}}n.captures.pop()}if(null!=e.castleRookId){var u=o.getPieceById(e.castleRookId),l=s.FILE[e.endCoord[1]]==s.FILE.c?"a":"h",p=u.getCoord(),d=l+p[1];u.possibleMoves.push(d),u.move(this.board.getCellByCoord(d)),u.hasMoved=!1,this.board.getCellByCoord(p).piece=null}this.turns.pop(),this.draw()}},e.prototype.updateStatus=function(e){var t=this.turns[this.turns.length-1];null!=t&&t.msgs.push(e)},e.prototype.whosTurn=function(){return this.turns.length%2?s.SIDE.black:s.SIDE.white},e}();t.Match=h},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){this.board=e}return e.prototype.detectCheck=function(e,t){for(var i=0;i<t.pieces.length;i++){var s=t.pieces[i];if(!s.captured&&(s.canMove(this.board),s.possibleMoves.includes(e)))return!0}return!1},e.prototype.detectCheckMate=function(e,t){var i=this,s=!0;return e.pieces.forEach((function(o){new Array;var r=i.board.getCellByCoord(o.getCoord());o.captured||o.canMove(i.board).forEach((function(n){var c,a=i.board.getCellByCoord(n),h=a.piece;o.possibleMoves=[n],o.move(a),c=e.pieces[15].getCoord(),i.detectCheck(c,t)||(s=!1),a.piece=null,o.possibleMoves=[r.getCoord()],o.move(r),null!=h&&(a.piece=h)}))})),s},e}();t.ChessAi=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),o=i(11),r=function(){function e(){this.undoBtn=new o.UiBtn("↶ Undo",91,32,s.CANVASMARGIN,94,"#900","#fff"),this.resetBtn=new o.UiBtn("↻ Reset",91,32,s.CANVASMARGIN,129),this.loadBtn=new o.UiBtn("📁 Load",91,32,s.CANVASMARGIN+91+3,94),this.saveBtn=new o.UiBtn("💾 Save",91,32,s.CANVASMARGIN+91+3,129,"#090","#fff")}return e.prototype._clickedBtn=function(e,t){return e.offsetX>=t.x&&e.offsetX<=t.x+t.width&&e.offsetY>=t.y&&e.offsetY<=t.y+t.height},e.prototype.clickedUndoBtn=function(e){return this._clickedBtn(e,this.undoBtn)},e.prototype.clickedLoadBtn=function(e){return this._clickedBtn(e,this.loadBtn)},e.prototype.clickedResetBtn=function(e){return this._clickedBtn(e,this.resetBtn)},e.prototype.clickedSaveBtn=function(e){return this._clickedBtn(e,this.saveBtn)},e.prototype.draw=function(e,t,i,o){var r=0+s.CANVASMARGIN,n=15+s.CANVASMARGIN,c=200+s.CANVASMARGIN,a=15+s.CANVASMARGIN,h=["Score:","White: "+t,"Black: "+i],u=25;e.beginPath(),e.fillStyle="white",e.font=s.UIFONTLARGE,h.forEach((function(t,i){i>0&&(e.font=s.UIFONTSMALL),i>1&&(u=23),e.fillText(t,r,n+i*u,200)})),e.closePath();var l=new Array;u=25;for(var p=0;p<5;p++){var d=o[o.length-1-p];if(null!=d)for(var f=0;f<d.msgs.length;f++){var v=d.msgs[d.msgs.length-f-1];l.push(v)}if(4==p)for(;l.length>5;)l.pop()}e.beginPath(),e.fillStyle="white",e.font=s.UIFONTLARGE,e.fillText("Game Log:",c,a),e.font=s.UIFONTSMALL,l.forEach((function(t,i){i>0&&(e.fillStyle="#999"),e.fillText(t,c,a+(i+1)*u)})),e.closePath(),[this.undoBtn,this.resetBtn,this.loadBtn,this.saveBtn].forEach((function(t){e.beginPath(),e.fillStyle=t.bgColor,e.fillRect(t.x,t.y,t.width,t.height),e.fillStyle=t.textColor,e.font=s.UIFONTBTN,e.textAlign="center",e.fillText(t.title,t.x+t.width/2,t.y+22),e.closePath(),e.textAlign="left"}))},e}();t.ChessUi=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t,i,s,o,r,n){void 0===r&&(r="#333"),void 0===n&&(n="#ccc"),this.width=t,this.height=i,this.x=s,this.y=o,this.title=e,this.bgColor=r,this.textColor=n};t.UiBtn=s},function(e,t,i){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(e){function t(t,i){var s=e.call(this,t,r.PIECETYPE.bishop,i)||this;return s.value=325,s.possibleMoves=["c1","f1","c8","f8"],s}return o(t,e),t.prototype.canMove=function(e){return this.active=!0,this.possibleMoves=[],this.possibleMoves=this.possibleMoves.concat(this.getDiagMoves(e,!0,!1),this.getDiagMoves(e,!0,!0),this.getDiagMoves(e,!1,!1),this.getDiagMoves(e,!1,!0)),this.possibleMoves},t}(i(1).Piece);t.Bishop=n},function(e,t,i){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(e){function t(t,i){var s=e.call(this,t,r.PIECETYPE.king,i)||this;return s.hasMoved=!1,s.origCoord=["e1","e8"],s.value=5e4,s.possibleMoves=s.origCoord,s}return o(t,e),t.prototype.canMove=function(e){var t,i,s=this._coord[0],o=parseInt(this._coord[1]),n=new Array;(this.possibleMoves=[],this.hasMoved||e.getCellByCoord("f"+o).isOccupied()||e.getCellByCoord("g"+o).isOccupied()||!e.getCellByCoord("h"+o).isOccupied())||((t=e.getCellByCoord("h"+o).piece).type!=r.PIECETYPE.rook||t.hasMoved||((i=e.getCellByCoord("g"+o)).possibleMove=!0,i.castleable=!0,this.possibleMoves.push(i.getCoord())));this.hasMoved||e.getCellByCoord("d"+o).isOccupied()||e.getCellByCoord("c"+o).isOccupied()||e.getCellByCoord("b"+o).isOccupied()||!e.getCellByCoord("a"+o).isOccupied()||((t=e.getCellByCoord("a"+o).piece).type!=r.PIECETYPE.rook||t.hasMoved||((i=e.getCellByCoord("c"+o)).possibleMove=!0,i.castleable=!0,this.possibleMoves.push(i.getCoord())));n.push(""+r.FILE[r.FILE[s]+1]+o),n.push(""+r.FILE[r.FILE[s]-1]+o),n.push(""+s+(o+1)),n.push(""+s+(o-1)),n.push(""+r.FILE[r.FILE[s]+1]+(o+1)),n.push(""+r.FILE[r.FILE[s]-1]+(o-1)),n.push(""+r.FILE[r.FILE[s]-1]+(o+1)),n.push(""+r.FILE[r.FILE[s]+1]+(o-1));for(var c=0;c<n.length;c++){var a=n[c];if(e.cellInBounds(a)){var h=e.getCellByCoord(a);if(h.isOccupied()){h.piece.side!=this.side&&(this.possibleMoves.push(a),h.possibleMove=!0);continue}this.possibleMoves.push(a),h.possibleMove=!0}}return this.possibleMoves},t.prototype.castleMove=function(e,t){if(e.castleable&&!this.hasMoved){var i=e.file==r.FILE.c?"a":"h",s=e.rank,o=(e.file==r.FILE.c?"d":"f")+s,n=t.getCellByCoord(i+s),c=n.piece;return n.piece=null,c.possibleMoves.push(o),c.move(t.getCellByCoord(o)),this.move(e),c.getId()}this.move(e)},t.prototype.move=function(t){return!(!e.prototype.move.call(this,t)||!(t.file!=r.FILE.e||this.side==r.SIDE.black&&8!=t.rank||this.side==r.SIDE.white&&1!=t.rank))&&(this.hasMoved=!0,!0)},t}(i(1).Piece);t.King=n},function(e,t,i){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(e){function t(t,i){var s=e.call(this,t,r.PIECETYPE.pawn,i)||this;return s.hasMoved=!1,s.origCoord=["a2","b2","c2","d2","e2","f2","g2","h2","a7","b7","c7","d7","e7","f7","g7","h7"],s.value=100,s.possibleMoves=s.origCoord,s}return o(t,e),t.prototype.canMove=function(e){var t=this.getCoord()[0],i=parseInt(this.getCoord()[1]);this.active=!0,this.possibleMoves=[];var s=""+t+(i+this._forward),o=e.getCellByCoord(s);e.cellInBounds(s)&&!o.isOccupied()&&this.possibleMoves.push(s);var n=""+t+(i+this._forward+this._forward),c=e.getCellByCoord(n);this.hasMoved||!e.cellInBounds(n)||c.isOccupied()||o.isOccupied()||this.possibleMoves.push(n);var a=this.side==r.SIDE.white?r.SIDE.black:r.SIDE.white,h=""+r.FILE[r.FILE[t]-1]+(i+this._forward);e.cellInBounds(h)&&((u=e.getCellByCoord(h)).isOccupied()&&u.piece.side==a&&this.possibleMoves.push(h));var u,l=""+r.FILE[r.FILE[t]+1]+(i+this._forward);e.cellInBounds(l)&&((u=e.getCellByCoord(l)).isOccupied()&&u.piece.side==a&&this.possibleMoves.push(l));return this.possibleMoves.forEach((function(t){e.getCellByCoord(t).possibleMove=!0})),this.possibleMoves},t.prototype.move=function(t){return!(!e.prototype.move.call(this,t)||!(this.side==r.SIDE.black&&7!=t.rank||this.side==r.SIDE.white&&2!=t.rank))&&(this.hasMoved=!0,!0)},t}(i(1).Piece);t.Pawn=n},function(e,t,i){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(e){function t(t,i){var s=e.call(this,t,r.PIECETYPE.knight,i)||this;return s.value=325,s.possibleMoves=["g1","b1","g8","b8"],s}return o(t,e),t.prototype.canMove=function(e){var t=this._coord[0],i=parseInt(this._coord[1]),s=new Array;this.active=!0,this.possibleMoves=[],s.push(""+r.FILE[r.FILE[t]-1]+(i+this._forward+this._forward)),s.push(""+r.FILE[r.FILE[t]+1]+(i+this._forward+this._forward)),s.push(""+r.FILE[r.FILE[t]-2]+(i+this._forward)),s.push(""+r.FILE[r.FILE[t]+2]+(i+this._forward)),s.push(""+r.FILE[r.FILE[t]-1]+(i-this._forward-this._forward)),s.push(""+r.FILE[r.FILE[t]+1]+(i-this._forward-this._forward)),s.push(""+r.FILE[r.FILE[t]-2]+(i-this._forward)),s.push(""+r.FILE[r.FILE[t]+2]+(i-this._forward));for(var o=0;o<s.length;o++){var n=s[o];if(e.cellInBounds(n)){var c=e.getCellByCoord(n);c.isOccupied()&&c.piece.side==this.side||(this.possibleMoves.push(n),c.possibleMove=!0)}}return this.possibleMoves},t}(i(1).Piece);t.Knight=n},function(e,t,i){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(e){function t(t,i){var s=e.call(this,t,r.PIECETYPE.queen,i)||this;return s.value=1e3,s.possibleMoves=["d1","d8"],s}return o(t,e),t.prototype.canMove=function(e){return this.active=!0,this.possibleMoves=[],this.possibleMoves=this.possibleMoves.concat(this.getDiagMoves(e,!0,!1),this.getDiagMoves(e,!0,!0),this.getDiagMoves(e,!1,!1),this.getDiagMoves(e,!1,!0)),this.possibleMoves=this.possibleMoves.concat(this.getPerpMoves(e,!0,!0),this.getPerpMoves(e,!0,!1),this.getPerpMoves(e,!1,!0),this.getPerpMoves(e,!1,!1)),this.possibleMoves},t}(i(1).Piece);t.Queen=n},function(e,t,i){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=function(e){function t(t,i){var s=e.call(this,t,r.PIECETYPE.rook,i)||this;return s.hasMoved=!1,s.origCoord=["a1","h1","a8","h8"],s.value=550,s.possibleMoves=s.origCoord,s}return o(t,e),t.prototype.canMove=function(e){return this.active=!0,this.possibleMoves=[],this.possibleMoves=this.possibleMoves.concat(this.getPerpMoves(e,!0,!0),this.getPerpMoves(e,!0,!1),this.getPerpMoves(e,!1,!0),this.getPerpMoves(e,!1,!1)),this.possibleMoves},t.prototype.move=function(t){return e.prototype.move.call(this,t)&&(t.file!=r.FILE.a&&t.file!=r.FILE.h||this.side==r.SIDE.black&&8!=t.rank||this.side==r.SIDE.white&&1!=t.rank)&&(this.hasMoved=!0),!1},t}(i(1).Piece);t.Rook=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t){return this.capture=null,this.endCoord="",this.movedPiece=null,this.side=null,this.startCoord="",this.msgs=new Array,this.castleRookId=null,2==t.length?(this.movedPiece=e,this.side=this.movedPiece.side,this.startCoord=this.movedPiece.getCoord(),this.endCoord=t,this):null};t.Turn=s}]);